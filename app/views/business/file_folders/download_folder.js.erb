$(".loading-<%= @file_folder.id %>").removeClass('hide');
$(".download-folder-<%= @file_folder.id %>").addClass('hide');
let requestloop = setInterval(function () {
    $.ajax({
        type: 'GET',
        url: '/business/file_folders/' + "<%= params[:id] %>" + '/check_zip',
        format: 'json',
        success: function (data) {
            if (data.complete) {
                clearInterval(requestloop);
                download_zip(data.path, "<%= @file_folder.name %>.zip");
                $(".loading-<%= @file_folder.id %>").addClass('hide');
                $(".download-folder-<%= @file_folder.id %>").removeClass('hide');
            }
        }
    });
}, 3000);

function download_zip(path, filename) {
    let element = document.createElement('a');
    element.setAttribute('href', path);
    element.setAttribute('download', filename);
    element.style.display = 'none';
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
}

